UPDATE apac_orch.cntl_etl_sql
   SET sql_txt = 'Insert into jp_rpt_a.d_rpt_prd
SELECT dp.prd_sk, dp.prd_id, dp.lcl_ctry_cd, dp.pset_cd, dp.prd_nm, dp.prd_shrt_ds, dp.prd_hiery_lvl, dp.prd_brd_type, dp.prd_secdy_lang_ds, dp.prd_brd_nm, dp.prd_brd_secdy_lang_nm, dp.prd_dsg_nm, dp.prd_dsg_secdy_lang_nm, dp.prd_strg_ds, dp.prd_strg_secdy_lang_ds, dp.prd_pkg_ds, dp.prd_pkg_secdy_lang_ds, dp.prd_gner_nm, dp.prd_gner_secdy_lang_nm, dp.prd_smpl_ind, dp.prd_mfgr_nm, dp.prd_mfgr_secdy_lang_nm, dp.prd_atc_cd, dp.prd_lnh_dt, dp.glbl_prd_set_id, dp.glbl_prd_ds, dp.glbl_bms_prd_ind, dp.glbl_ta_ds, dp.cmp_flg, dp.src_strt_dt, dp.src_end_dt, dp.eff_strt_dt, dp.eff_end_dt, dp.actv_flag, dp.cycl_time_id, dp.scen_id, dp.inrt_dt, dp.inrt_by, dp.modf_dt, dp.modf_by, dp.md5_val, dp.prd_nm_disp, dp.prd_nm_disp1, 
        CASE
            WHEN ra.attr_id IS NULL THEN 1000
            ELSE ra.attr_id
        END AS prd_rank
   FROM (((((((( SELECT -999 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''Market Volume''::character varying AS prd_nm, ''Market Volume''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''市場規模''::character varying AS prd_nm_disp, ''市場シェア（％)''::character varying AS prd_nm_disp1
UNION ALL 
         SELECT -9999 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''OR (SC+AI)''::character varying AS prd_nm, ''OR (SC+AI)''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''OR (SC+AI)''::character varying AS prd_nm_disp, ''OR (SC+AI)''::character varying AS prd_nm_disp1)
UNION ALL 
         SELECT -99 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''All''::character varying AS prd_nm, ''ALL''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''全て''::character varying AS prd_nm_disp, ''全て''::character varying AS prd_nm_disp1)
UNION ALL 
         SELECT -98 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''All - only key product''::character varying AS prd_nm, ''All - only key product''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''全て (主力製品のみ)''::character varying AS prd_nm_disp, ''全て (主力製品のみ)''::character varying AS prd_nm_disp1)
UNION ALL 
         SELECT -100 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''TOTAL (IM)''::character varying AS prd_nm, ''TOTAL (IM)''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''TOTAL (IM)''::character varying AS prd_nm_disp, ''TOTAL (IM)''::character varying AS prd_nm_disp1)
UNION ALL 
         SELECT -101 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''TOTAL (ONC)''::character varying AS prd_nm, ''TOTAL (ONC)''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''TOTAL (ONC)''::character varying AS prd_nm_disp, ''TOTAL (ONC)''::character varying AS prd_nm_disp1)
UNION ALL 
         SELECT -102 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''TOTAL (ONC1)''::character varying AS prd_nm, ''TOTAL (ONC1)''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''TOTAL (ONC1)''::character varying AS prd_nm_disp, ''TOTAL (ONC1)''::character varying AS prd_nm_disp1)
UNION ALL 
         SELECT -103 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''TOTAL (ONC2)''::character varying AS prd_nm, ''TOTAL (ONC2)''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''TOTAL (ONC2)''::character varying AS prd_nm_disp, ''TOTAL (ONC2)''::character varying AS prd_nm_disp1
UNION ALL
		SELECT -1001 AS prd_sk, ''-1001''::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''ONC1 irAE''::character varying AS prd_nm, ''ONC1 irAE''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''ONC1 irAE''::character varying AS prd_nm_disp, ''ONC1 irAE''::character varying AS prd_nm_disp1
UNION ALL
		SELECT -1002 AS prd_sk, ''-1002''::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''ONC2 irAE''::character varying AS prd_nm, ''ONC2 irAE''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''ONC2 irAE''::character varying AS prd_nm_disp, ''ONC2 irAE''::character varying AS prd_nm_disp1
UNION ALL
		SELECT -1003 AS prd_sk, ''-1003''::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''HEMA irAE''::character varying AS prd_nm, ''HEMA irAE''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''HEMA irAE''::character varying AS prd_nm_disp, ''HEMA irAE''::character varying AS prd_nm_disp1
UNION ALL 
        SELECT -104 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''TOTAL (HEMA)''::character varying AS prd_nm, ''TOTAL (HEMA)''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''TOTAL (HEMA)''::character varying AS prd_nm_disp, ''TOTAL (HEMA)''::character varying AS prd_nm_disp1
UNION ALL 
         SELECT -88 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''All - HEMA Celgene Products''::character varying AS prd_nm, ''All - HEMA Celgene Products''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''REV, POM, IST''::character varying AS prd_nm_disp, ''REV, POM, IST''::character varying AS prd_nm_disp1
UNION ALL 
         SELECT -77 AS prd_sk, NULL::character varying AS prd_id, NULL::character varying AS lcl_ctry_cd, NULL::character varying AS pset_cd, ''All - HEMA BMS Products''::character varying AS prd_nm, ''All - HEMA BMS Products''::character varying AS prd_shrt_ds, NULL::character varying AS prd_hiery_lvl, NULL::character varying AS prd_brd_type, NULL::character varying AS prd_secdy_lang_ds, NULL::character varying AS prd_brd_nm, NULL::character varying AS prd_brd_secdy_lang_nm, NULL::character varying AS prd_dsg_nm, NULL::character varying AS prd_dsg_secdy_lang_nm, NULL::character varying AS prd_strg_ds, NULL::character varying AS prd_strg_secdy_lang_ds, NULL::character varying AS prd_pkg_ds, NULL::character varying AS prd_pkg_secdy_lang_ds, NULL::character varying AS prd_gner_nm, NULL::character varying AS prd_gner_secdy_lang_nm, NULL::character varying AS prd_smpl_ind, NULL::character varying AS prd_mfgr_nm, NULL::character varying AS prd_mfgr_secdy_lang_nm, NULL::character varying AS prd_atc_cd, NULL::date AS prd_lnh_dt, NULL::character varying AS glbl_prd_set_id, NULL::character varying AS glbl_prd_ds, NULL::character varying AS glbl_bms_prd_ind, NULL::character varying AS glbl_ta_ds, NULL::character varying AS cmp_flg, NULL::date AS src_strt_dt, NULL::date AS src_end_dt, NULL::date AS eff_strt_dt, NULL::date AS eff_end_dt, NULL::integer AS actv_flag, NULL::integer AS cycl_time_id, NULL::integer AS scen_id, NULL::timestamp without time zone AS inrt_dt, NULL::character varying AS inrt_by, NULL::timestamp without time zone AS modf_dt, NULL::character varying AS modf_by, NULL::character varying AS md5_val, ''SP, EM''::character varying AS prd_nm_disp, ''SP, EM''::character varying AS prd_nm_disp1)
		 
UNION ALL 
         SELECT dp.pset_sk AS prd_sk, dp.pset_id AS prd_id, dp.lcl_ctry_cd, dp.pset_cd, dp.prd_ds AS prd_nm, dp.prd_shrt_ds, dp.prd_hiery_lvl, dp.prd_brd_type, dp.prd_secdy_lang_ds, dp.prd_brd_nm, dp.prd_brd_secdy_lang_nm, dp.prd_dsg_nm, dp.prd_dsg_secdy_lang_nm, dp.prd_strg_ds, dp.prd_strg_secdy_lang_ds, dp.prd_pkg_ds, dp.prd_pkg_secdy_lang_ds, dp.prd_gner_nm, dp.prd_gner_secdy_lang_nm, dp.prd_smpl_ind, dp.prd_mfgr_nm, dp.prd_mfgr_secdy_lang_nm, dp.prd_atc_cd, dp.prd_lnh_dt, dp.glbl_prd_set_id, dp.glbl_prd_ds, dp.glbl_bms_prd_ind, dp.glbl_ta_ds, dp.bms_prd_ind AS cmp_flg, dp.src_strt_dt, dp.src_end_dt, dp.eff_strt_dt, dp.eff_end_dt, dp.actv_flag, dp.cycl_time_id, dp.scen_id, dp.inrt_dt, dp.inrt_by, dp.modf_dt, dp.modf_by, dp.md5_val, 
                CASE
                    WHEN dp.prd_shrt_ds IS NULL AND dp.prd_brd_nm IS NOT NULL THEN dp.prd_brd_nm
                    WHEN dp.prd_shrt_ds IS NULL AND dp.prd_brd_nm IS NULL THEN dp.prd_ds
                    ELSE dp.prd_shrt_ds
                END AS prd_nm_disp, 
                CASE
                    WHEN dp.prd_shrt_ds IS NULL AND dp.prd_brd_nm IS NOT NULL THEN dp.prd_brd_nm
                    WHEN dp.prd_shrt_ds IS NULL AND dp.prd_brd_nm IS NULL THEN dp.prd_ds
                    ELSE dp.prd_shrt_ds
                END AS prd_nm_disp1
           FROM jp2a_cdw.d_pset dp) dp
   LEFT JOIN jp2a_cdw.ref_attr ra ON dp.prd_shrt_ds::text = ra.attr_cd::text AND ra.attr_typ::text = ''Product Rank''::character varying::text;'
WHERE sql_id = 50724;
